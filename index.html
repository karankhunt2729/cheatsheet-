<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Cheatsheet Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Matrix Theme (Default) */
            --bg-primary: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0d1b2a 100%);
            --bg-secondary: rgba(0, 20, 0, 0.8);
            --bg-header: linear-gradient(135deg, #001122 0%, #003300 50%, #000000 100%);
            --text-primary: #00ff41;
            --text-secondary: #006600;
            --border-primary: #00ff41;
            --border-secondary: #006600;
            --accent-primary: #00ff88;
            --shadow-primary: rgba(0,255,65,0.3);
            --shadow-secondary: rgba(0,255,65,0.2);
            --gradient-button: linear-gradient(135deg, #003300 0%, #006600 100%);
            --gradient-button-hover: linear-gradient(135deg, #006600 0%, #009900 100%);
        }

        [data-theme="cyberpunk"] {
            --bg-primary: linear-gradient(135deg, #0a0a0a 0%, #2a0a2a 50%, #0a0a2a 100%);
            --bg-secondary: rgba(20, 0, 20, 0.8);
            --bg-header: linear-gradient(135deg, #220011 0%, #330033 50%, #110022 100%);
            --text-primary: #ff0099;
            --text-secondary: #660033;
            --border-primary: #ff0099;
            --border-secondary: #660033;
            --accent-primary: #ff66cc;
            --shadow-primary: rgba(255,0,153,0.3);
            --shadow-secondary: rgba(255,0,153,0.2);
            --gradient-button: linear-gradient(135deg, #330033 0%, #660066 100%);
            --gradient-button-hover: linear-gradient(135deg, #660066 0%, #990099 100%);
        }

        [data-theme="ocean"] {
            --bg-primary: linear-gradient(135deg, #0a1a2a 0%, #1a2a3a 50%, #0a2a3a 100%);
            --bg-secondary: rgba(0, 20, 40, 0.8);
            --bg-header: linear-gradient(135deg, #001122 0%, #003366 50%, #002244 100%);
            --text-primary: #00ccff;
            --text-secondary: #0066aa;
            --border-primary: #00ccff;
            --border-secondary: #0066aa;
            --accent-primary: #66ddff;
            --shadow-primary: rgba(0,204,255,0.3);
            --shadow-secondary: rgba(0,204,255,0.2);
            --gradient-button: linear-gradient(135deg, #003366 0%, #006699 100%);
            --gradient-button-hover: linear-gradient(135deg, #006699 0%, #0099cc 100%);
        }

        [data-theme="fire"] {
            --bg-primary: linear-gradient(135deg, #2a0a0a 0%, #3a1a0a 50%, #2a1a0a 100%);
            --bg-secondary: rgba(40, 20, 0, 0.8);
            --bg-header: linear-gradient(135deg, #220011 0%, #663300 50%, #441100 100%);
            --text-primary: #ff6600;
            --text-secondary: #aa3300;
            --border-primary: #ff6600;
            --border-secondary: #aa3300;
            --accent-primary: #ff9966;
            --shadow-primary: rgba(255,102,0,0.3);
            --shadow-secondary: rgba(255,102,0,0.2);
            --gradient-button: linear-gradient(135deg, #663300 0%, #996600 100%);
            --gradient-button-hover: linear-gradient(135deg, #996600 0%, #cc9900 100%);
        }

        [data-theme="purple"] {
            --bg-primary: linear-gradient(135deg, #1a0a2a 0%, #2a0a3a 50%, #1a0a3a 100%);
            --bg-secondary: rgba(30, 0, 40, 0.8);
            --bg-header: linear-gradient(135deg, #110022 0%, #330066 50%, #220044 100%);
            --text-primary: #9966ff;
            --text-secondary: #6633aa;
            --border-primary: #9966ff;
            --border-secondary: #6633aa;
            --accent-primary: #cc99ff;
            --shadow-primary: rgba(153,102,255,0.3);
            --shadow-secondary: rgba(153,102,255,0.2);
            --gradient-button: linear-gradient(135deg, #330066 0%, #660099 100%);
            --gradient-button-hover: linear-gradient(135deg, #660099 0%, #9900cc 100%);
        }

        [data-theme="terminal"] {
            --bg-primary: linear-gradient(135deg, #000000 0%, #111111 50%, #000000 100%);
            --bg-secondary: rgba(0, 0, 0, 0.9);
            --bg-header: linear-gradient(135deg, #000000 0%, #222222 50%, #111111 100%);
            --text-primary: #00ff00;
            --text-secondary: #008800;
            --border-primary: #00ff00;
            --border-secondary: #008800;
            --accent-primary: #88ff88;
            --shadow-primary: rgba(0,255,0,0.3);
            --shadow-secondary: rgba(0,255,0,0.2);
            --gradient-button: linear-gradient(135deg, #002200 0%, #004400 100%);
            --gradient-button-hover: linear-gradient(135deg, #004400 0%, #006600 100%);
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--bg-header);
            color: var(--text-primary);
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px var(--shadow-primary);
            border-bottom: 2px solid var(--border-primary);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .sidebar {
            width: 300px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 20px var(--shadow-secondary);
            height: fit-content;
        }

        .content-area {
            flex: 1;
            background: var(--bg-secondary);
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 20px var(--shadow-secondary);
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-primary);
            border-radius: 6px;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.8);
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 10px var(--shadow-primary);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .add-button, .info-button, .theme-button, .admin-button {
            width: 100%;
            padding: 12px;
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 2px solid var(--border-primary);
            border-radius: 6px;
            font-size: 16px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .add-button:hover, .info-button:hover, .theme-button:hover, .admin-button:hover {
            background: var(--gradient-button-hover);
            box-shadow: 0 0 15px var(--shadow-primary);
            transform: translateY(-2px);
        }

        .theme-button {
            margin-bottom: 20px;
        }

        .cheatsheet-list {
            list-style: none;
        }

        .cheatsheet-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--border-secondary);
            background: rgba(0, 0, 0, 0.3);
        }

        .cheatsheet-item:hover {
            background-color: var(--shadow-secondary);
            border-color: var(--border-primary);
            box-shadow: 0 0 10px var(--shadow-primary);
        }

        .cheatsheet-item.active {
            background-color: var(--shadow-secondary);
            color: var(--text-primary);
            border-color: var(--accent-primary);
        }

        .cheatsheet-name {
            flex: 1;
            font-weight: 500;
        }

        .delete-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .cheatsheet-item:hover .delete-button {
            opacity: 1;
        }

        .editor-container {
            display: none;
        }

        .editor-container.active {
            display: block;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #006600;
        }

        .editor-buttons {
            display: flex;
            gap: 10px;
        }

        .editor-title {
            font-size: 1.8em;
            color: #333;
        }

        .save-button, .export-button {
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 2px solid var(--border-primary);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        .save-button:hover, .export-button:hover {
            background: var(--gradient-button-hover);
            box-shadow: 0 0 15px var(--shadow-primary);
        }

        .toolbar {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .toolbar-button {
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        .toolbar-button:hover {
            background: var(--gradient-button-hover);
            box-shadow: 0 0 10px var(--shadow-primary);
        }

        .editor-textarea {
            width: 100%;
            height: 500px;
            padding: 15px;
            border: 2px solid var(--border-primary);
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.8);
            color: var(--text-primary);
        }

        .editor-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 15px var(--shadow-primary);
        }

        .editor-textarea::placeholder {
            color: var(--text-secondary);
        }

        .welcome-message {
            text-align: center;
            color: #666;
            margin-top: 50px;
        }

        .welcome-message h2 {
            font-size: 2em;
            margin-bottom: 15px;
        }

        .welcome-message p {
            font-size: 1.2em;
            margin-bottom: 30px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 3px solid var(--border-primary);
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px var(--shadow-primary);
        }

        .modal-header {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .modal-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-primary);
            border-radius: 6px;
            font-size: 16px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 10px var(--shadow-primary);
        }

        .modal-input::placeholder {
            color: var(--text-secondary);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal-button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .modal-button.primary {
            background: linear-gradient(135deg, #003300 0%, #006600 100%);
            color: #00ff41;
            border: 2px solid #00ff41;
            font-family: 'Courier New', monospace;
        }

        .modal-button.secondary {
            background: linear-gradient(135deg, #330000 0%, #660000 100%);
            color: #ff6666;
            border: 2px solid #ff6666;
            font-family: 'Courier New', monospace;
        }

        .modal-button:hover {
            opacity: 0.9;
        }

        .empty-state {
            text-align: center;
            color: #006600;
            padding: 40px;
        }

        .empty-state h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        /* Authentication Styles */
        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #001100 50%, #000000 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .auth-box {
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #00ff41;
            border-radius: 10px;
            padding: 40px;
            width: 400px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0,255,65,0.5);
        }

        .auth-title {
            color: #00ff41;
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0,255,65,0.5);
        }

        .auth-subtitle {
            color: #006600;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .auth-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #00ff41;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            text-align: center;
            letter-spacing: 3px;
            margin-bottom: 20px;
        }

        .auth-input:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(0,255,65,0.7);
        }

        .auth-input::placeholder {
            color: #006600;
            letter-spacing: normal;
        }

        .auth-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #003300 0%, #006600 100%);
            color: #00ff41;
            border: 2px solid #00ff41;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-button:hover {
            background: linear-gradient(135deg, #006600 0%, #009900 100%);
            box-shadow: 0 0 20px rgba(0,255,65,0.6);
        }

        .auth-error {
            color: #ff4444;
            margin-top: 15px;
            font-size: 14px;
        }

        .auth-form {
            width: 100%;
        }

        .auth-links {
            text-align: center;
            margin-top: 20px;
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .link-button {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-secondary);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            transition: all 0.3s;
        }

        .link-button:hover {
            color: var(--text-primary);
            border-color: var(--border-primary);
            box-shadow: 0 0 10px var(--shadow-primary);
        }

        /* Admin Panel Styles */
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-secondary);
        }

        .admin-tab {
            background: transparent;
            color: var(--text-secondary);
            border: none;
            padding: 12px 20px;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }

        .admin-tab:hover {
            color: var(--text-primary);
            background: var(--bg-primary);
        }

        .admin-tab.active {
            color: var(--text-primary);
            background: var(--bg-primary);
            border-bottom-color: var(--border-primary);
        }

        .admin-tab-content {
            min-height: 300px;
        }

        .admin-section h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .admin-section p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .user-item, .permission-item {
            background: var(--bg-primary);
            border: 1px solid var(--border-secondary);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info, .permission-info {
            flex: 1;
        }

        .user-name, .permission-name {
            color: var(--text-primary);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .user-details, .permission-details {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .user-actions, .permission-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: var(--gradient-button-hover);
            box-shadow: 0 0 8px var(--shadow-primary);
        }

        .action-btn.danger {
            background: linear-gradient(135deg, #660000 0%, #990000 100%);
            border-color: #ff6666;
            color: #ff6666;
        }

        .action-btn.danger:hover {
            background: linear-gradient(135deg, #990000 0%, #cc0000 100%);
            box-shadow: 0 0 8px rgba(255,102,102,0.5);
        }

        .premium-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%);
            color: #000;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 10px;
        }

        /* Access Selector Styles */
        .access-selector {
            margin-bottom: 20px;
        }

        .access-tabs {
            display: flex;
            gap: 5px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 5px;
        }

        .access-tab {
            flex: 1;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            transition: all 0.3s;
        }

        .access-tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
        }

        .access-tab.active {
            color: var(--text-primary);
            background: var(--gradient-button);
            box-shadow: 0 0 8px var(--shadow-primary);
        }

        /* Profile Section Styles */
        .profile-section {
            background: var(--bg-primary);
            border: 1px solid var(--border-secondary);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .profile-name {
            color: var(--text-primary);
            font-weight: bold;
        }

        .profile-role {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .profile-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .profile-btn {
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        .profile-btn:hover {
            background: var(--gradient-button-hover);
            box-shadow: 0 0 8px var(--shadow-primary);
        }

        .welcome-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #00ff41;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            z-index: 3000;
            box-shadow: 0 0 50px rgba(0,255,65,0.8);
            animation: welcomeGlow 2s ease-in-out;
        }

        @keyframes welcomeGlow {
            0%, 100% { box-shadow: 0 0 50px rgba(0,255,65,0.8); }
            50% { box-shadow: 0 0 80px rgba(0,255,65,1); }
        }

        .welcome-title {
            color: #00ff41;
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(0,255,65,0.8);
        }

        .welcome-message-text {
            color: #006600;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .welcome-close {
            background: var(--gradient-button);
            color: var(--text-primary);
            border: 2px solid var(--border-primary);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
        }

        /* Theme Selector Styles */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .theme-card {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-secondary);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-card:hover {
            border-color: var(--border-primary);
            box-shadow: 0 0 15px var(--shadow-primary);
            transform: translateY(-3px);
        }

        .theme-card.active {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--shadow-primary);
        }

        .theme-preview {
            width: 100%;
            height: 60px;
            border-radius: 4px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .matrix-preview {
            background: linear-gradient(135deg, #0a0a0a 0%, #003300 50%, #000000 100%);
            border: 1px solid #00ff41;
        }

        .cyberpunk-preview {
            background: linear-gradient(135deg, #0a0a0a 0%, #330033 50%, #110022 100%);
            border: 1px solid #ff0099;
        }

        .ocean-preview {
            background: linear-gradient(135deg, #0a1a2a 0%, #003366 50%, #002244 100%);
            border: 1px solid #00ccff;
        }

        .fire-preview {
            background: linear-gradient(135deg, #2a0a0a 0%, #663300 50%, #441100 100%);
            border: 1px solid #ff6600;
        }

        .purple-preview {
            background: linear-gradient(135deg, #1a0a2a 0%, #330066 50%, #220044 100%);
            border: 1px solid #9966ff;
        }

        .terminal-preview {
            background: linear-gradient(135deg, #000000 0%, #222222 50%, #111111 100%);
            border: 1px solid #00ff00;
        }

        .theme-name {
            color: var(--text-primary);
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .theme-desc {
            color: var(--text-secondary);
            font-size: 12px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                order: 2;
            }

            .content-area {
                order: 1;
            }

            .header h1 {
                font-size: 2em;
            }

            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Screen -->
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <h1 class="auth-title">🔒 ACCESS REQUIRED</h1>
            <p class="auth-subtitle" id="authSubtitle">Enter Security PIN to continue</p>
            
            <!-- Access Type Selector -->
            <div id="accessSelector" class="access-selector">
                <div class="access-tabs">
                    <button class="access-tab active" onclick="showUserLogin()">User Login</button>
                    <button class="access-tab" onclick="showAdminLogin()">Admin Access</button>
                </div>
            </div>

            <!-- User Login Form -->
            <div id="userLoginForm" class="auth-form">
                <input type="text" id="usernameInput" class="auth-input" placeholder="Username" maxlength="20">
                <input type="password" id="passwordInput" class="auth-input" placeholder="Password">
                <button class="auth-button" onclick="authenticateUser()">LOGIN</button>
                <div class="auth-links">
                    <button onclick="showSignupForm()" class="link-button">Create Account</button>
                </div>
            </div>

            <!-- Admin Login Form -->
            <div id="adminLoginForm" class="auth-form" style="display: none;">
                <input type="password" id="adminPinInput" class="auth-input" placeholder="Admin PIN" maxlength="6">
                <button class="auth-button" onclick="authenticateAdmin()">ADMIN ACCESS</button>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="auth-form" style="display: none;">
                <input type="text" id="signupUsername" class="auth-input" placeholder="Username" maxlength="20">
                <input type="password" id="signupPassword" class="auth-input" placeholder="Create Password">
                <input type="password" id="confirmPassword" class="auth-input" placeholder="Confirm Password">
                <div class="auth-buttons">
                    <button onclick="createAccount()" class="auth-button">CREATE ACCOUNT</button>
                    <button onclick="showUserLogin()" class="link-button">Back to Login</button>
                </div>
            </div>

            <div class="auth-error" id="authError"></div>
        </div>
    </div>

    <!-- Welcome Popup -->
    <div class="welcome-popup" id="welcomePopup" style="display: none;">
        <h2 class="welcome-title">WELCOME BACK</h2>
        <p class="welcome-message-text">BitMonk</p>
        <p class="welcome-message-text">Access granted to Cybersecurity Cheatsheet Manager</p>
        <button class="welcome-close" onclick="closeWelcome()">CONTINUE</button>
    </div>

    <div class="header">
        <h1>🔒 Cybersecurity Cheatsheet Manager</h1>
        <p>Organize and manage your cybersecurity knowledge</p>
    </div>

    <div class="container">
        <div class="main-content">
            <div class="sidebar">
                <!-- Profile Section -->
                <div class="profile-section" id="profileSection">
                    <div class="profile-header">
                        <div>
                            <div class="profile-name" id="profileName">Loading...</div>
                            <div class="profile-role" id="profileRole">User</div>
                        </div>
                    </div>
                    <div class="profile-actions">
                        <button class="profile-btn" onclick="showChangePassword()">🔑 Change Password</button>
                        <button class="profile-btn" onclick="logout()">🚪 Logout</button>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="Search cheatsheets...">
                </div>
                
                <button class="add-button" onclick="showAddModal()">
                    ➕ Add New Cheatsheet
                </button>
                
                <button class="info-button" onclick="showStorageInfo()">
                    ℹ️ Storage Info
                </button>
                
                <button class="theme-button" id="themeButton" onclick="showThemeSelector()">
                    🎨 Change Theme
                </button>
                
                <button class="admin-button" id="adminButton" onclick="showAdminPanel()" style="display: none;">
                    👨‍💼 Admin Panel
                </button>
                
                <ul class="cheatsheet-list" id="cheatsheetList">
                    <!-- Cheatsheet items will be dynamically inserted here -->
                </ul>
            </div>

            <div class="content-area">
                <div class="welcome-message" id="welcomeMessage">
                    <h2>Welcome to Your Cheatsheet Manager!</h2>
                    <p>Create your first cybersecurity cheatsheet to get started.</p>
                    <p>Click the "Add New Cheatsheet" button to begin organizing your knowledge.</p>
                </div>

                <div class="editor-container" id="editorContainer">
                    <div class="editor-header">
                        <h2 class="editor-title" id="editorTitle">Untitled Cheatsheet</h2>
                        <div class="editor-buttons">
                            <button class="save-button" onclick="saveCurrentCheatsheet()">💾 Save</button>
                            <button class="export-button" onclick="exportCheatsheet()">📤 Export</button>
                        </div>
                    </div>
                    
                    <div class="toolbar">
                        <button class="toolbar-button" onclick="formatText('**', '**')" title="Bold">
                            <strong>B</strong>
                        </button>
                        <button class="toolbar-button" onclick="formatText('*', '*')" title="Italic">
                            <em>I</em>
                        </button>
                        <button class="toolbar-button" onclick="formatText('`', '`')" title="Inline Code">
                            &lt;/&gt;
                        </button>
                        <button class="toolbar-button" onclick="formatText('```\n', '\n```')" title="Code Block">
                            📋
                        </button>
                        <button class="toolbar-button" onclick="formatText('# ', '')" title="Heading">
                            H1
                        </button>
                        <button class="toolbar-button" onclick="formatText('- ', '')" title="Bullet Point">
                            • List
                        </button>
                    </div>
                    
                    <textarea class="editor-textarea" id="editorTextarea" placeholder="Start typing your cheatsheet content here...

You can use markdown-style formatting:
- **Bold text**
- *Italic text*
- `inline code`
- ```code blocks```
- # Headings
- - Bullet points

Example content:
# SQL Injection Prevention
- Always use parameterized queries
- Validate and sanitize user input
- Use stored procedures when possible
- Apply principle of least privilege

## Example Code
```sql
-- Bad (vulnerable)
SELECT * FROM users WHERE id = '" + userInput + "';

-- Good (safe)
SELECT * FROM users WHERE id = ?;
```"></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Cheatsheet Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <h3 class="modal-header">Create New Cheatsheet</h3>
            <input type="text" id="cheatsheetNameInput" class="modal-input" placeholder="Enter cheatsheet name...">
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="hideAddModal()">Cancel</button>
                <button class="modal-button primary" onclick="createCheatsheet()">Create</button>
            </div>
        </div>
    </div>

    <!-- Storage Info Modal -->
    <div class="modal" id="storageModal">
        <div class="modal-content">
            <h3 class="modal-header">📊 Storage Information</h3>
            <div style="color: #00ff41; font-family: 'Courier New', monospace; line-height: 1.8;">
                <div style="margin-bottom: 20px;">
                    <strong>🔒 Data Security:</strong><br>
                    • All data is stored locally in your browser<br>
                    • No data is sent to external servers<br>
                    • Your cheatsheets are private and secure<br>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <strong>💾 Storage Capacity:</strong><br>
                    • Browser localStorage: ~5-10 MB per domain<br>
                    • Enough for thousands of cheatsheets<br>
                    • <span id="storageUsage">Calculating usage...</span><br>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <strong>📤 Data Persistence:</strong><br>
                    • Data persists between browser sessions<br>
                    • Will remain until you clear browser data<br>
                    • Use Export feature to backup cheatsheets<br>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <strong>⚠️ Important Notes:</strong><br>
                    • Clear browser data = lose all cheatsheets<br>
                    • Export important cheatsheets regularly<br>
                    • Private/incognito mode won't save data<br>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button primary" onclick="hideStorageModal()">Got It</button>
            </div>
        </div>
    </div>

    <!-- Theme Selector Modal -->
    <div class="modal" id="themeModal">
        <div class="modal-content">
            <h3 class="modal-header">🎨 Choose Your Theme</h3>
            <div class="theme-grid">
                <div class="theme-card" onclick="applyTheme('matrix')" data-theme="matrix">
                    <div class="theme-preview matrix-preview"></div>
                    <div class="theme-name">Matrix</div>
                    <div class="theme-desc">Classic green hacker style</div>
                </div>
                
                <div class="theme-card" onclick="applyTheme('cyberpunk')" data-theme="cyberpunk">
                    <div class="theme-preview cyberpunk-preview"></div>
                    <div class="theme-name">Cyberpunk</div>
                    <div class="theme-desc">Neon pink futuristic</div>
                </div>
                
                <div class="theme-card" onclick="applyTheme('ocean')" data-theme="ocean">
                    <div class="theme-preview ocean-preview"></div>
                    <div class="theme-name">Ocean</div>
                    <div class="theme-desc">Deep blue underwater</div>
                </div>
                
                <div class="theme-card" onclick="applyTheme('fire')" data-theme="fire">
                    <div class="theme-preview fire-preview"></div>
                    <div class="theme-name">Fire</div>
                    <div class="theme-desc">Warm orange flames</div>
                </div>
                
                <div class="theme-card" onclick="applyTheme('purple')" data-theme="purple">
                    <div class="theme-preview purple-preview"></div>
                    <div class="theme-name">Purple</div>
                    <div class="theme-desc">Royal violet magic</div>
                </div>
                
                <div class="theme-card" onclick="applyTheme('terminal')" data-theme="terminal">
                    <div class="theme-preview terminal-preview"></div>
                    <div class="theme-name">Terminal</div>
                    <div class="theme-desc">Classic green terminal</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="hideThemeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal" id="adminModal">
        <div class="modal-content" style="max-width: 900px;">
            <h3 class="modal-header">👨‍💼 Admin Panel</h3>
            
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="showAdminTab('users')">User Management</button>
                <button class="admin-tab" onclick="showAdminTab('permissions')">Premium Permissions</button>
            </div>
            
            <!-- User Management Tab -->
            <div id="adminUsersTab" class="admin-tab-content">
                <div class="admin-section">
                    <h4>Registered Users</h4>
                    <div class="users-list" id="usersList">
                        <!-- Users will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Premium Permissions Tab -->
            <div id="adminPermissionsTab" class="admin-tab-content" style="display: none;">
                <div class="admin-section">
                    <h4>Premium Feature Access</h4>
                    <p>Grant or revoke premium features for users:</p>
                    <div class="permissions-list" id="permissionsList">
                        <!-- Permissions will be populated here -->
                    </div>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="hideAdminPanel()">Close</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <h3 class="modal-header">🔑 Change Password</h3>
            <div id="changePasswordContent">
                <input type="password" id="currentPassword" class="modal-input" placeholder="Current Password">
                <input type="password" id="newPassword" class="modal-input" placeholder="New Password">
                <input type="password" id="confirmNewPassword" class="modal-input" placeholder="Confirm New Password">
            </div>
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="hideChangePassword()">Cancel</button>
                <button class="modal-button primary" onclick="updatePassword()">Update Password</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let cheatsheets = {};
        let currentCheatsheetId = null;
        let isEditing = false;
        let isAuthenticated = false;
        let currentUser = null;
        let users = {};
        const VALID_PIN = "909913";
        const ADMIN_PIN = "909913"; // Admin uses same PIN for now

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedTheme();
            loadUsers();
            checkAuthentication();
            if (isAuthenticated) {
                hideAuthContainer();
                loadCheatsheets();
                renderCheatsheetList();
                setupEventListeners();
                updateUIForUserRole();
            } else {
                setupAuthEventListeners();
            }
        });

        // User Management Functions
        function loadUsers() {
            const storedUsers = localStorage.getItem('bitmonk-users');
            if (storedUsers) {
                users = JSON.parse(storedUsers);
            } else {
                // Initialize with admin account
                users = {
                    'admin': {
                        id: 'admin',
                        username: 'BitMonk',
                        password: ADMIN_PIN, // Admin uses PIN as password
                        role: 'admin',
                        premiumAccess: true,
                        created: Date.now()
                    }
                };
                saveUsers();
            }
        }

        function saveUsers() {
            localStorage.setItem('bitmonk-users', JSON.stringify(users));
        }

        // Authentication functions
        function checkAuthentication() {
            const authData = localStorage.getItem('bitmonk-auth');
            if (authData) {
                try {
                    const authInfo = JSON.parse(authData);
                    if (authInfo.userId && users[authInfo.userId]) {
                        currentUser = users[authInfo.userId];
                        isAuthenticated = true;
                    }
                } catch (e) {
                    // Legacy authentication, convert to admin
                    if (authData === 'authenticated') {
                        currentUser = users['admin'];
                        isAuthenticated = true;
                        localStorage.setItem('bitmonk-auth', JSON.stringify({userId: 'admin'}));
                    }
                }
            }
        }

        // Authentication tab switching
        function showUserLogin() {
            document.getElementById('userLoginForm').style.display = 'block';
            document.getElementById('adminLoginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('authSubtitle').textContent = 'Login with username and password';
            
            // Update tab styles
            document.querySelectorAll('.access-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('[onclick="showUserLogin()"]').classList.add('active');
            
            clearAuthErrors();
        }

        function showAdminLogin() {
            document.getElementById('userLoginForm').style.display = 'none';
            document.getElementById('adminLoginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('authSubtitle').textContent = 'Admin access with PIN';
            
            // Update tab styles
            document.querySelectorAll('.access-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('[onclick="showAdminLogin()"]').classList.add('active');
            
            clearAuthErrors();
        }

        function authenticateUser() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const errorDiv = document.getElementById('authError');

            if (!username || !password) {
                errorDiv.textContent = 'Please enter both username and password';
                return;
            }

            // Find user by username and password
            const user = Object.values(users).find(u => 
                u.username.toLowerCase() === username.toLowerCase() && u.password === password
            );

            if (user) {
                currentUser = user;
                localStorage.setItem('bitmonk-auth', JSON.stringify({userId: user.id}));
                isAuthenticated = true;
                completeLogin();
            } else {
                errorDiv.textContent = 'Invalid username or password';
                document.getElementById('passwordInput').value = '';
                setTimeout(() => {
                    errorDiv.textContent = '';
                }, 3000);
            }
        }

        function authenticateAdmin() {
            const pin = document.getElementById('adminPinInput').value;
            const errorDiv = document.getElementById('authError');

            if (pin === ADMIN_PIN) {
                currentUser = users['admin'];
                localStorage.setItem('bitmonk-auth', JSON.stringify({userId: 'admin'}));
                isAuthenticated = true;
                completeLogin();
            } else {
                errorDiv.textContent = 'Invalid admin PIN';
                document.getElementById('adminPinInput').value = '';
                setTimeout(() => {
                    errorDiv.textContent = '';
                }, 3000);
            }
        }

        function clearAuthErrors() {
            document.getElementById('authError').textContent = '';
        }

        function completeLogin() {
            hideAuthContainer();
            showWelcomePopup();
            loadCheatsheets();
            renderCheatsheetList();
            setupEventListeners();
            updateUIForUserRole();
        }

        // User account creation
        function showSignupForm() {
            document.getElementById('userLoginForm').style.display = 'none';
            document.getElementById('adminLoginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            document.getElementById('authSubtitle').textContent = 'Create new account';
            clearAuthErrors();
        }

        function createAccount() {
            const username = document.getElementById('signupUsername').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const errorDiv = document.getElementById('authError');

            // Validation
            if (!username || username.length < 3) {
                errorDiv.textContent = 'Username must be at least 3 characters';
                return;
            }

            if (!password || password.length < 6) {
                errorDiv.textContent = 'Password must be at least 6 characters';
                return;
            }

            if (password !== confirmPassword) {
                errorDiv.textContent = 'Passwords do not match';
                return;
            }

            // Check if username already exists
            const existingUser = Object.values(users).find(u => u.username.toLowerCase() === username.toLowerCase());
            if (existingUser) {
                errorDiv.textContent = 'Username already exists';
                return;
            }

            // Create new user
            const userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5);
            users[userId] = {
                id: userId,
                username: username,
                password: password,
                role: 'user',
                premiumAccess: false,
                created: Date.now()
            };

            saveUsers();
            
            // Auto-login new user
            currentUser = users[userId];
            localStorage.setItem('bitmonk-auth', JSON.stringify({userId: userId}));
            isAuthenticated = true;
            completeLogin();
        }

        // Role-based UI updates
        function updateUIForUserRole() {
            if (!currentUser) return;

            // Update welcome message
            const welcomeText = document.querySelector('.welcome-message-text');
            if (welcomeText) {
                welcomeText.textContent = currentUser.username;
            }

            // Update profile section
            document.getElementById('profileName').textContent = currentUser.username;
            document.getElementById('profileRole').textContent = currentUser.role === 'admin' ? 'Administrator' : 'User';

            // Show/hide admin panel
            const adminButton = document.getElementById('adminButton');
            if (currentUser.role === 'admin') {
                adminButton.style.display = 'block';
            } else {
                adminButton.style.display = 'none';
            }

            // Show/hide premium features
            const themeButton = document.getElementById('themeButton');
            if (currentUser.premiumAccess || currentUser.role === 'admin') {
                themeButton.style.display = 'block';
            } else {
                themeButton.style.display = 'none';
            }
        }

        // Profile and password management
        function showChangePassword() {
            document.getElementById('changePasswordModal').classList.add('active');
            
            // Clear form
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
        }

        function hideChangePassword() {
            document.getElementById('changePasswordModal').classList.remove('active');
        }

        function updatePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;

            // Validation
            if (!currentPassword) {
                alert('Please enter your current password');
                return;
            }

            if (currentUser.password !== currentPassword) {
                alert('Current password is incorrect');
                return;
            }

            if (!newPassword || newPassword.length < 6) {
                alert('New password must be at least 6 characters');
                return;
            }

            if (newPassword !== confirmNewPassword) {
                alert('New passwords do not match');
                return;
            }

            if (currentPassword === newPassword) {
                alert('New password must be different from current password');
                return;
            }

            // Update password
            currentUser.password = newPassword;
            users[currentUser.id] = currentUser;
            saveUsers();

            alert('Password updated successfully');
            hideChangePassword();
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('bitmonk-auth');
                location.reload();
            }
        }

        // Theme selector with permission check
        function showThemeSelector() {
            if (!currentUser.premiumAccess && currentUser.role !== 'admin') {
                alert('Theme customization is a premium feature. Contact admin for access.');
                return;
            }
            document.getElementById('themeModal').classList.add('active');
            highlightCurrentTheme();
        }

        // Admin Panel Functions
        function showAdminPanel() {
            if (currentUser.role !== 'admin') {
                alert('Access denied. Admin privileges required.');
                return;
            }
            document.getElementById('adminModal').classList.add('active');
            showAdminTab('users');
            loadAdminData();
        }

        function hideAdminPanel() {
            document.getElementById('adminModal').classList.remove('active');
        }

        function showAdminTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[onclick="showAdminTab('${tabName}')"]`).classList.add('active');

            // Show/hide tab content
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).style.display = 'block';

            if (tabName === 'users') {
                renderUsersList();
            } else if (tabName === 'permissions') {
                renderPermissionsList();
            }
        }

        function loadAdminData() {
            renderUsersList();
            renderPermissionsList();
        }

        function renderUsersList() {
            const usersList = document.getElementById('usersList');
            const userEntries = Object.values(users);

            if (userEntries.length === 0) {
                usersList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No users registered</p>';
                return;
            }

            usersList.innerHTML = userEntries.map(user => `
                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">
                            ${user.username}
                            ${user.role === 'admin' ? '<span style="color: #ffd700;">[ADMIN]</span>' : ''}
                            ${user.premiumAccess ? '<span class="premium-badge">PREMIUM</span>' : ''}
                        </div>
                        <div class="user-details">
                            ID: ${user.id} | Created: ${new Date(user.created).toLocaleDateString()} | Role: ${user.role} | Auth: ${user.role === 'admin' ? 'PIN' : 'Password'}
                        </div>
                    </div>
                    <div class="user-actions">
                        ${user.id !== 'admin' ? `
                            <button class="action-btn" onclick="togglePremiumAccess('${user.id}')">
                                ${user.premiumAccess ? 'Remove Premium' : 'Grant Premium'}
                            </button>
                            <button class="action-btn danger" onclick="deleteUser('${user.id}')">Delete</button>
                        ` : '<span style="color: var(--text-secondary);">Protected Account</span>'}
                    </div>
                </div>
            `).join('');
        }

        function renderPermissionsList() {
            const permissionsList = document.getElementById('permissionsList');
            const regularUsers = Object.values(users).filter(u => u.role !== 'admin');

            if (regularUsers.length === 0) {
                permissionsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No regular users to manage</p>';
                return;
            }

            permissionsList.innerHTML = regularUsers.map(user => `
                <div class="permission-item">
                    <div class="permission-info">
                        <div class="permission-name">
                            ${user.username}
                            ${user.premiumAccess ? '<span class="premium-badge">PREMIUM</span>' : ''}
                        </div>
                        <div class="permission-details">
                            Theme Access: ${user.premiumAccess ? 'Granted' : 'Denied'} | 
                            Status: ${user.premiumAccess ? 'Premium User' : 'Standard User'}
                        </div>
                    </div>
                    <div class="permission-actions">
                        <button class="action-btn" onclick="togglePremiumAccess('${user.id}')">
                            ${user.premiumAccess ? 'Revoke Premium' : 'Grant Premium'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function togglePremiumAccess(userId) {
            if (currentUser.role !== 'admin') {
                alert('Access denied. Admin privileges required.');
                return;
            }

            const user = users[userId];
            if (!user) return;

            user.premiumAccess = !user.premiumAccess;
            saveUsers();
            
            // Update UI if this is the current user
            if (currentUser.id === userId) {
                currentUser = user;
                updateUIForUserRole();
            }

            // Refresh admin panel
            loadAdminData();
            
            alert(`Premium access ${user.premiumAccess ? 'granted to' : 'revoked from'} ${user.username}`);
        }

        function deleteUser(userId) {
            if (currentUser.role !== 'admin') {
                alert('Access denied. Admin privileges required.');
                return;
            }

            if (userId === 'admin') {
                alert('Cannot delete admin account');
                return;
            }

            const user = users[userId];
            if (!user) return;

            if (confirm(`Are you sure you want to delete user "${user.username}"? This action cannot be undone.`)) {
                delete users[userId];
                saveUsers();
                loadAdminData();
                alert(`User "${user.username}" has been deleted.`);
            }
        }

        function hideAuthContainer() {
            document.getElementById('authContainer').style.display = 'none';
        }

        function showWelcomePopup() {
            document.getElementById('welcomePopup').style.display = 'block';
        }

        function closeWelcome() {
            document.getElementById('welcomePopup').style.display = 'none';
        }

        function setupAuthEventListeners() {
            // User login form
            document.getElementById('usernameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('passwordInput').focus();
                }
            });
            
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    authenticateUser();
                }
            });

            // Admin login form
            document.getElementById('adminPinInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    authenticateAdmin();
                }
            });

            // Signup form
            document.getElementById('signupUsername').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('signupPassword').focus();
                }
            });
            
            document.getElementById('signupPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('confirmPassword').focus();
                }
            });
            
            document.getElementById('confirmPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    createAccount();
                }
            });

            // Change password form
            document.getElementById('currentPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('newPassword').focus();
                }
            });
            
            document.getElementById('newPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('confirmNewPassword').focus();
                }
            });
            
            document.getElementById('confirmNewPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    updatePassword();
                }
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                filterCheatsheets(searchTerm);
            });

            // Auto-save functionality
            document.getElementById('editorTextarea').addEventListener('input', function() {
                if (currentCheatsheetId) {
                    // Auto-save after 1 second of inactivity
                    clearTimeout(window.autoSaveTimer);
                    window.autoSaveTimer = setTimeout(saveCurrentCheatsheet, 1000);
                }
            });

            // Modal keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    hideAddModal();
                }
                if (e.key === 'Enter' && document.getElementById('addModal').classList.contains('active')) {
                    createCheatsheet();
                }
            });

            // Keyboard shortcuts for formatting
            document.getElementById('editorTextarea').addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'b':
                            e.preventDefault();
                            formatText('**', '**');
                            break;
                        case 'i':
                            e.preventDefault();
                            formatText('*', '*');
                            break;
                        case 's':
                            e.preventDefault();
                            saveCurrentCheatsheet();
                            break;
                    }
                }
            });
        }

        // Load cheatsheets from localStorage
        function loadCheatsheets() {
            const saved = localStorage.getItem('cybersecurity-cheatsheets');
            if (saved) {
                try {
                    cheatsheets = JSON.parse(saved);
                } catch (e) {
                    console.error('Error loading cheatsheets:', e);
                    cheatsheets = {};
                }
            }
        }

        // Save cheatsheets to localStorage
        function saveCheatsheets() {
            try {
                localStorage.setItem('cybersecurity-cheatsheets', JSON.stringify(cheatsheets));
            } catch (e) {
                console.error('Error saving cheatsheets:', e);
                alert('Error saving cheatsheets. Your storage might be full.');
            }
        }

        // Render the cheatsheet list
        function renderCheatsheetList() {
            const listContainer = document.getElementById('cheatsheetList');
            listContainer.innerHTML = '';

            const cheatsheetIds = Object.keys(cheatsheets).sort((a, b) => 
                cheatsheets[b].lastModified - cheatsheets[a].lastModified
            );

            if (cheatsheetIds.length === 0) {
                listContainer.innerHTML = '<div class="empty-state"><h3>No cheatsheets yet</h3><p>Create your first cheatsheet to get started!</p></div>';
                return;
            }

            cheatsheetIds.forEach(id => {
                const cheatsheet = cheatsheets[id];
                const listItem = document.createElement('li');
                listItem.className = 'cheatsheet-item';
                listItem.innerHTML = `
                    <div class="cheatsheet-name">${escapeHtml(cheatsheet.name)}</div>
                    <button class="delete-button" onclick="deleteCheatsheet('${id}')" title="Delete cheatsheet">🗑️</button>
                `;
                listItem.addEventListener('click', function(e) {
                    if (!e.target.classList.contains('delete-button')) {
                        openCheatsheet(id);
                    }
                });
                listContainer.appendChild(listItem);
            });
        }

        // Filter cheatsheets based on search term
        function filterCheatsheets(searchTerm) {
            const items = document.querySelectorAll('.cheatsheet-item');
            items.forEach(item => {
                const name = item.querySelector('.cheatsheet-name').textContent.toLowerCase();
                const cheatsheetId = Array.from(item.parentNode.children).indexOf(item);
                const content = Object.values(cheatsheets)[cheatsheetId]?.content?.toLowerCase() || '';
                
                if (name.includes(searchTerm) || content.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Show add cheatsheet modal
        function showAddModal() {
            document.getElementById('addModal').classList.add('active');
            document.getElementById('cheatsheetNameInput').focus();
        }

        // Hide add cheatsheet modal
        function hideAddModal() {
            document.getElementById('addModal').classList.remove('active');
            document.getElementById('cheatsheetNameInput').value = '';
        }

        // Show storage info modal
        function showStorageInfo() {
            document.getElementById('storageModal').classList.add('active');
            calculateStorageUsage();
        }

        // Hide storage info modal
        function hideStorageModal() {
            document.getElementById('storageModal').classList.remove('active');
        }

        // Calculate storage usage
        function calculateStorageUsage() {
            try {
                const dataString = JSON.stringify(cheatsheets);
                const sizeInBytes = new Blob([dataString]).size;
                const sizeInKB = (sizeInBytes / 1024).toFixed(2);
                const sizeInMB = (sizeInBytes / (1024 * 1024)).toFixed(2);
                
                let usageText = '';
                if (sizeInBytes < 1024) {
                    usageText = `Current usage: ${sizeInBytes} bytes`;
                } else if (sizeInBytes < 1024 * 1024) {
                    usageText = `Current usage: ${sizeInKB} KB`;
                } else {
                    usageText = `Current usage: ${sizeInMB} MB`;
                }
                
                const cheatsheetCount = Object.keys(cheatsheets).length;
                usageText += ` (${cheatsheetCount} cheatsheets)`;
                
                document.getElementById('storageUsage').textContent = usageText;
            } catch (error) {
                document.getElementById('storageUsage').textContent = 'Unable to calculate usage';
            }
        }

        // Theme management functions
        function showThemeSelector() {
            document.getElementById('themeModal').classList.add('active');
            highlightCurrentTheme();
        }

        function hideThemeModal() {
            document.getElementById('themeModal').classList.remove('active');
        }

        function highlightCurrentTheme() {
            const currentTheme = localStorage.getItem('bitmonk-theme') || 'matrix';
            document.querySelectorAll('.theme-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.theme === currentTheme) {
                    card.classList.add('active');
                }
            });
        }

        function applyTheme(themeName) {
            // Save theme preference
            localStorage.setItem('bitmonk-theme', themeName);
            
            // Apply theme to body
            if (themeName === 'matrix') {
                document.body.removeAttribute('data-theme');
            } else {
                document.body.setAttribute('data-theme', themeName);
            }
            
            // Update active state
            highlightCurrentTheme();
            
            // Close modal after a short delay to show the effect
            setTimeout(() => {
                hideThemeModal();
            }, 500);
        }

        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('bitmonk-theme');
            if (savedTheme && savedTheme !== 'matrix') {
                document.body.setAttribute('data-theme', savedTheme);
            }
        }

        // Create a new cheatsheet
        function createCheatsheet() {
            const nameInput = document.getElementById('cheatsheetNameInput');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Please enter a name for the cheatsheet');
                return;
            }

            // Check if name already exists
            const existingNames = Object.values(cheatsheets).map(c => c.name.toLowerCase());
            if (existingNames.includes(name.toLowerCase())) {
                alert('A cheatsheet with this name already exists');
                return;
            }

            const id = 'cs_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            cheatsheets[id] = {
                id: id,
                name: name,
                content: '',
                created: Date.now(),
                lastModified: Date.now()
            };

            saveCheatsheets();
            renderCheatsheetList();
            hideAddModal();
            openCheatsheet(id);
        }

        // Open a cheatsheet for editing
        function openCheatsheet(id) {
            if (currentCheatsheetId === id) return;
            
            currentCheatsheetId = id;
            const cheatsheet = cheatsheets[id];
            
            if (!cheatsheet) {
                console.error('Cheatsheet not found:', id);
                return;
            }

            // Update UI
            document.getElementById('welcomeMessage').style.display = 'none';
            document.getElementById('editorContainer').classList.add('active');
            document.getElementById('editorTitle').textContent = cheatsheet.name;
            document.getElementById('editorTextarea').value = cheatsheet.content;

            // Update active state in sidebar
            document.querySelectorAll('.cheatsheet-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const cheatsheetIds = Object.keys(cheatsheets).sort((a, b) => 
                cheatsheets[b].lastModified - cheatsheets[a].lastModified
            );
            const index = cheatsheetIds.indexOf(id);
            if (index >= 0) {
                const items = document.querySelectorAll('.cheatsheet-item');
                if (items[index]) {
                    items[index].classList.add('active');
                }
            }

            // Focus on editor
            document.getElementById('editorTextarea').focus();
        }

        // Save current cheatsheet
        function saveCurrentCheatsheet() {
            if (!currentCheatsheetId) return;
            
            const content = document.getElementById('editorTextarea').value;
            cheatsheets[currentCheatsheetId].content = content;
            cheatsheets[currentCheatsheetId].lastModified = Date.now();
            
            saveCheatsheets();
            
            // Visual feedback
            const saveButton = document.querySelector('.save-button');
            const originalText = saveButton.textContent;
            saveButton.textContent = '✅ Saved';
            saveButton.style.background = '#27ae60';
            
            setTimeout(() => {
                saveButton.textContent = originalText;
                saveButton.style.background = '';
            }, 1000);
        }

        // Export current cheatsheet as text file
        function exportCheatsheet() {
            if (!currentCheatsheetId) {
                alert('Please select a cheatsheet to export');
                return;
            }
            
            const cheatsheet = cheatsheets[currentCheatsheetId];
            if (!cheatsheet) {
                alert('Cheatsheet not found');
                return;
            }
            
            // Create file content with header
            const header = `# ${cheatsheet.name}\n`;
            const dateCreated = `Created: ${new Date(cheatsheet.created).toLocaleDateString()}\n`;
            const dateModified = `Last Modified: ${new Date(cheatsheet.lastModified).toLocaleDateString()}\n`;
            const separator = `${'='.repeat(50)}\n\n`;
            
            const fileContent = header + dateCreated + dateModified + separator + cheatsheet.content;
            
            // Create and download file
            const blob = new Blob([fileContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${cheatsheet.name.replace(/[^a-zA-Z0-9]/g, '_')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            // Visual feedback
            const exportButton = document.querySelector('.export-button');
            const originalText = exportButton.textContent;
            exportButton.textContent = '✅ Exported';
            exportButton.style.background = '#0099ff';
            
            setTimeout(() => {
                exportButton.textContent = originalText;
                exportButton.style.background = '';
            }, 1000);
        }

        // Delete a cheatsheet
        function deleteCheatsheet(id) {
            const cheatsheet = cheatsheets[id];
            if (!cheatsheet) return;
            
            if (confirm(`Are you sure you want to delete "${cheatsheet.name}"? This action cannot be undone.`)) {
                delete cheatsheets[id];
                saveCheatsheets();
                
                // If we're currently editing this cheatsheet, close the editor
                if (currentCheatsheetId === id) {
                    currentCheatsheetId = null;
                    document.getElementById('editorContainer').classList.remove('active');
                    document.getElementById('welcomeMessage').style.display = 'block';
                }
                
                renderCheatsheetList();
            }
        }

        // Format text with markdown-style formatting
        function formatText(startTag, endTag) {
            const textarea = document.getElementById('editorTextarea');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            const formattedText = startTag + selectedText + endTag;
            
            textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
            
            // Set cursor position
            const newCursorPos = start + startTag.length + selectedText.length;
            textarea.setSelectionRange(newCursorPos, newCursorPos);
            textarea.focus();
            
            // Trigger auto-save
            if (currentCheatsheetId) {
                clearTimeout(window.autoSaveTimer);
                window.autoSaveTimer = setTimeout(saveCurrentCheatsheet, 1000);
            }
        }

        // Utility function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Export functionality (bonus feature)
        function exportCheatsheets() {
            const dataStr = JSON.stringify(cheatsheets, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'cybersecurity-cheatsheets-' + new Date().toISOString().split('T')[0] + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Import functionality (bonus feature)
        function importCheatsheets() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (confirm('This will merge the imported cheatsheets with your existing ones. Continue?')) {
                            Object.assign(cheatsheets, importedData);
                            saveCheatsheets();
                            renderCheatsheetList();
                            alert('Cheatsheets imported successfully!');
                        }
                    } catch (error) {
                        alert('Error importing cheatsheets: Invalid file format');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        // Add keyboard shortcut info
        function showKeyboardShortcuts() {
            alert(`Keyboard Shortcuts:
            
Ctrl+B (Cmd+B): Bold text
Ctrl+I (Cmd+I): Italic text
Ctrl+S (Cmd+S): Save cheatsheet
Escape: Close modals
Enter: Create cheatsheet (in modal)

Editor Shortcuts:
- **text** for bold
- *text* for italic
- \`code\` for inline code
- \`\`\`code\`\`\` for code blocks
- # for headings
- - for bullet points`);
        }

        // Initialize tooltips and help
        document.addEventListener('DOMContentLoaded', function() {
            // Add help button to header
            const header = document.querySelector('.header');
            const helpButton = document.createElement('button');
            helpButton.innerHTML = '❓ Help';
            helpButton.style.cssText = `
                position: absolute;
                top: 20px;
                right: 20px;
                background: rgba(255,255,255,0.2);
                color: white;
                border: 1px solid rgba(255,255,255,0.3);
                padding: 8px 16px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 14px;
            `;
            helpButton.onclick = showKeyboardShortcuts;
            header.style.position = 'relative';
            header.appendChild(helpButton);
        });
    </script>
</body>
</html>
